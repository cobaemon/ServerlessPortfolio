{% extends "account/base_entrance.html" %}
{% load static %}
{% load i18n %}
{% load csp %}
{% load allauth %}
{% load form_tags %}

{% block extra_body_head_title %}
    {% trans "Change Password" %}
{% endblock extra_body_head_title %}

{% block extra_body_form %}
    {% element h1 %}
        {% if token_fail %}
            {% trans "Bad Token" %}
        {% endif %}
    {% endelement %}
    {% if token_fail %}
        {% url 'account_reset_password' as passwd_reset_url %}
        {% element p %}
            {% blocktrans %}The password reset link was invalid, possibly because it has already been used.  Please request a <a href="{{ passwd_reset_url }}">new password reset</a>.{% endblocktrans %}
        {% endelement %}
    {% else %}
        <form id="passwordResetForm" method="post" action="{{ attrs.action }}" >
            {% csrf_token %}
            <div class="form-floating mb-3">
                {{ form.password1|add_attrs:'class:form-control,placeholder:Enter new password...' }}
                <label for="{{ form.password1.id_for_label }}">{{ form.password1.label }}</label>
                {% if form.password1.errors %}
                    {% for error in form.password1.errors %}
                        <div class="invalid-feedback">{{ error }}</div>
                    {% endfor %}
                {% endif %}
            </div>
            <div class="form-floating mb-3">
                {{ form.password2|add_attrs:'class:form-control,placeholder:Confirm new password...' }}
                <label for="{{ form.password2.id_for_label }}">{{ form.password2.label }}</label>
                {% if form.password2.errors %}
                    {% for error in form.password2.errors %}
                        <div class="invalid-feedback">{{ error }}</div>
                    {% endfor %}
                {% endif %}
            </div>
            <button class="btn btn-primary btn-xl float-end" id="submitButton" type="submit">{% trans "Reset My Password" %}</button>
        </form>
    {% endif %}
{% endblock extra_body_form %}
